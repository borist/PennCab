{% load staticfiles %}

<head>
<link rel="stylesheet" type="text/css" href="{% static 'cabrides/style/bootstrap.css' %}" />
<link rel="stylesheet" type="text/css" href="{% static 'cabrides/style/bootstrap-responsive.css' %}" />
<style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .new-ride {
        margin-right: 10px;
      }
      .navbar-inverse .navbar-search .search-query {
        margin-top: 5px;
        /*background-color: #fff;*/
      }
    </style>

</head>

<body>
<div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <a class="brand" href="{% url 'cabrides:index' %}">PennCab</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              {% if user_rides %}
              <li class="active">
              {% else %}
              <li>
              {% endif %}
                <a href="{% url 'cabrides:view_user' %}">{{ user_name }}'s Rides</a></li>
              <li><a href="{% url 'cabrides:new_ride' %}">Create new ride!</a></li>
            </ul>

            <div class="pull-right">
              <ul class="nav">
                <li>
                  <form class="navbar-search pull-left">
                    <input type="text" class="search-query" placeholder="Search">
                  </form>
                </li>
                <li><a href="{% url 'cabrides:logout_user' %}">Logout</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

<div class="container">
{% if latest_rides %}
    {% for ride_tup in latest_rides %}
      {% if not ride_tup.0.ride_in_past %}
        <div class="hero-unit">
          <div class="container">
              <h2>Cab to {{ ride_tup.0.destination }}</h2>
              <div class="row">
                  <div class="span4">
                        Leaving from: <b>{{ ride_tup.0.origin }}</b><br/>
                        On: <b>{{ ride_tup.0.ride_date|date:'l, F d Y' }}</b> at <b>{{ ride_tup.0.ride_date|date:'H:i A' }}</b><br/>
                        Owner: <b>{{ ride_tup.0.ride_owner }}</b><br/>
                        Available Spots: <b>{{ ride_tup.0.num_available_spots }}</b>
                  </div>
                  <div class="span7">
                        Riders: <br/>
                        <table class="table">
                          <thead>
                            <tr>
                              <th>#</th>
                              <th>First Name</th>
                              <th>Last Name</th>
                              {% if ride_tup.1 %}
                              <th>Phone Number</th>
                              {% endif %}
                            </tr>
                          </thead>
                          <tbody>
                            {% for rider in ride_tup.0.participants.all %}
                              <tr>
                                <td>{{ forloop.counter }}</td>
                                <td>{{ rider.first_name }}</td>
                                <td>{{ rider.last_name }}</td>
                                {% if ride_tup.1 %}
                                <td>{{ rider.phone_number }}</td>
                                {% endif %}
                              </tr>
                            {% endfor %}
                          </tbody>
                        </table>

                          <form action="{% url 'cabrides:add_rider' ride_tup.0.id %}" method="post">
                          {% csrf_token %}
                          {% if ride_tup.2 %}
                          <button name="drop" type="submit" class="btn btn-danger pull-right">Delete This Ride</button>
                          {% elif ride_tup.1 %}
                          <button name="drop" type="submit" class="btn btn-danger pull-right">Leave This Ride</button>
                          {% elif ride_tup.0.num_available_spots > 0 %}
                          <button name="join" type="submit" class="btn btn-primary pull-right">Join This Ride</button>
                          {% endif %}
                          </form>
                  </div>
              </div>
          </div>
        </div>
      {% endif %}
    {% endfor %}
{% else %}
    <p>No Rides are available.</p>
{% endif %}
    
    <hr>
      <footer>
        <p>Created with Django and Bootstrap</p>
      </footer>

</div> <!-- container -->
</body>

